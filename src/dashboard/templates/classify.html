<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Classification</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  </head>
  <body class="p-4">
    <h1>Classification for {{ file }}</h1>
    <form method="post" class="mb-3">
      <div class="mb-3">
        <label class="form-label">Category</label>
        <select class="form-select" name="category">
          <option value="" {% if not data.category %}selected{% endif %}>No category</option>
          <option value="fuel" {% if data.category == 'fuel' %}selected{% endif %}>Gas</option>
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label">Job Name</label>
        <input class="form-control" type="text" name="job_name" value="{{ data.job_name or '' }}" placeholder="Enter job name">
      </div>
      <div class="mb-3">
        <label class="form-label">Total</label>
        <input class="form-control" type="text" name="total" value="{{ data.total if data.total is not none else '' }}" placeholder="e.g., 49.47">
        <div class="form-text">Use numbers only; commas allowed.</div>
      </div>
      <button class="btn btn-primary" type="submit">Save</button>
      <a class="btn btn-secondary" href="{{ url_for('index') }}">Cancel</a>
    </form>
    <h6>OCR text</h6>
    <pre style="white-space: pre-wrap">{{ data.raw_text }}</pre>
    <script>
      (function () {
        var sel = document.querySelector('select[name="category"]');
        var job = document.querySelector('input[name="job_name"]').closest('.mb-3');
        function sync() {
          var isFuel = (sel.value || '').toLowerCase() === 'fuel';
          var jobInput = job.querySelector('input[name="job_name"]');
          job.style.display = isFuel ? 'none' : '';
          jobInput.disabled = isFuel;
          if (isFuel) jobInput.value = '';
        }
        if (sel && job) {
          sel.addEventListener('change', sync);
          sync();
        }
      })();
    </script>
  </body>
</html>
